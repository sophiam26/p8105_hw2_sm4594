---
title: "Data Science HW#2"
author: "Sophia Miller"
date: "10/1/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Loading tidyverse
```{r tidyverse}
library(tidyverse)
```

# Problem 1
## Read and clean Mr. Trash Wheel sheet

```{r read_trashwheel}
library(readxl)
trashwheel_data = read_excel(
  path = "data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
  sheet = "Mr. Trash Wheel",
  range = "A2:N408",
  col_names = TRUE) %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  mutate(
    sports_balls = as.integer(round(sports_balls, 0))
    )
``` 

## Read and clean precipitation data for 2017

```{r precip_2017}
precip_data_2017 = read_excel(
  path = "data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
  sheet = "2017 Precipitation",
  col_names = TRUE,
  skip = 1) %>%
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2017)
```

## Read and clean precipitation data for 2018

```{r precip_2018}
precip_data_2018 = read_excel(
  path = "data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
  sheet = "2018 Precipitation",
  col_names = TRUE,
  skip = 1) %>%
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2018)
```

## Combine precipitation datasets and convert month to a character variable

```{r combine_precip}
precip_data = 
  full_join(precip_data_2017, precip_data_2018, by = NULL) %>%
 mutate(
    month = as.numeric(month),
    month = month.name[month]
    )
```

There are `r nrow(precip_data)` observations in the precipitation dataset. Key variables in the precipitation dataset include month, year, and total precipitation. Total precipitation in 2018 was `r sum(precip_data$total)`. There are in `r nrow(trashwheel_data)` observations the trashwheel dataset. Key variables include wight_tons, volume_cubic_yards, and homes_powered. The median number of sports balls in a dumpster in 2017 is `r median(pull(filter(trashwheel_data, year == 2017), sports_balls))`

# Problem 2

## Read and clean pols-month data

```{r pols_month}
pols_month_data = read_csv(file = "./data/pols-month.csv") %>%
janitor::clean_names() %>%
separate(mon, c("year","month","day")) %>%
  mutate(
    month = as.numeric(month),
    month = month.name[month],
    president = prez_dem,
    president = recode(president, '1' = "dem", '0' = "gop"),
    year = as.numeric(year)) %>%
  select(-day, -prez_gop, -prez_dem)
```
## Read and clean snp data

```{r snp}
snp_data = read_csv(file = "./data/snp.csv") %>%
janitor::clean_names() %>%
separate(date, c("month","day","year")) %>%
select(year, month, close, -day) %>%
  mutate(month = as.factor(month)) %>%
  arrange(year, month) %>%
mutate(
  month = month.name[(as.numeric(month))],
  year = as.numeric(year))
```

## Read and clean unemployment data

```{r unemployment}
unemployment_data = read_csv(file = "./data/unemployment.csv") %>%
janitor::clean_names() %>%
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "percent_unemployment") %>%
  mutate(
    month = recode(month, "jan" = "January", "feb" = "February", "mar" = "March", "apr" = "April", "may" = "May", "jun" = "June", "jul" = "July", "aug" = "August", "sep" = "September", "oct" = "October", "nov" = "November", "dec" = "December"),
    year = as.numeric(year))
```
## Join pols_month_data and snp_data

```{r combine_pols_snp}
pols_snp_data = 
  left_join(pols_month_data, snp_data, by = c("year", "month"))
```

## Join unemployment_data and pols_snp_data

```{r combine pols_snp_unemployment}
pols_snp_unemp_data = 
  left_join(pols_snp_data, unemployment_data, by = c("year", "month"))
```

The "pols-month" dataset contains information about the number of politicians who are democratic or republican at a given time point. The "snp" dataset contains information about the closing value of the Standard & Poor stock market index on a given date. The "unemployment" dataset contains information about the percentage of unemployment in a given month of an associated year. The dataset "pols_snp_unemp_data," which results from combining the pols-month, snp, and unemployment datasets, has `r nrow(pols_snp_unemp_data)` rows and `r ncol(pols_snp_unemp_data)` columns. Key variables in the "pols_snp_unemp_data" dataset include "year" "month" "president", "unemployment", and "close". 


# Problem 3

## Read and clean baby name popularity data

```{r baby_names}
baby_name_data = 
  read_csv("./data/Popular_Baby_Names.csv") %>%
  janitor::clean_names() %>%
  mutate(
    ethnicity = recode(ethnicity, "ASIAN AND PACI" = "ASIAN AND PACIFIC ISLANDER"),
    childs_first_name = str_to_upper(childs_first_name)) %>%
  distinct(.keep_all = TRUE)
```
## Scatterplot

```{r scatterplot}
baby_subset = 
  filter(baby_name_data, gender == "MALE", ethnicity == "WHITE NON HISPANIC", year_of_birth == "2016" )

ggplot(baby_subset, aes(x = rank, y = count)) + geom_point()
```



